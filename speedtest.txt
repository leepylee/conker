func main()
  // make choice
  num qty
  num button
  num listItem
  num pixlen
  num pathQty
  dialog 'Graphic Speed Test', 'Quantity', qty, 'Pixel length', pixlen, 'Paths', pathQty, listItem, 'Circles;Rectangles;Lines;Bitmaps', button, 'OK;Cancel'
  if button == 1
    stop
  end
  console false

  // bitmap
  bitmap b, 16, 16
  canvasmap b
  line 0,0,15,15
  line 0,15,15,0

  // path
  style FILLSTROKE
  num p
  if pathQty > 0
    str[] elements
    for i to qty
      num x = rnd(SCREENW)
      num y = rnd(SCREENH)
      num x2 = x + pixlen
      num y2 = y + pixlen
      str form
      if listItem == 0
        form = 'C{0} {1} {2} 0'
        x2 = pixlen
      else if listItem == 1
        form = 'R{0} {1} {2} {3} 0'
      else if listItem == 2
        form = 'M{0} {1} L{2} {3}'
      end
      format s, form, x, y, x2, y2
      add elements, s
    end
    str sp = join(elements, ' ')
    path p1, sp
    p = p1
  end

  // fps
  num timeOld = now()
  num frame
  num totalTime
    
end

func draw()
  style FILL
  if pathQty > 0
    for i to pathQty
      drawpath p, i*5, i*5
    end
  else
    for i to qty
      paint 255, rnd(256), rnd(256), rnd(256)
      num x = rnd(SCREENW)
      num y = rnd(SCREENH)
      if listItem == 0
        circle x, y, pixlen
      else if listItem == 1
        rect x, y, x + pixlen, y + pixlen
      else if listItem == 2
        line x, y, x + pixlen, y + pixlen
      else if listItem == 3
        drawbitmap b, x, y, 16 * pixlen, 16 * pixlen
      end 
    end
  end

  // fps
  frame++
  num timeNow = now()
  num fps = 1000 / (timeNow - timeOld)
  totalTime += fps
  if frame > 10
    textsize 50
    paint RED
    num avg = round(totalTime/frame)
    text MIDX, MIDY, avg + ' ' + qty
  end
  timeOld = timeNow
end  
