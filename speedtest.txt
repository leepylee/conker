func main()
  // make choice
  num qty
  num button
  num listItem
  num pixlen
  num pathQty
  dialog 'Quantity', qty, 'Pixel length', pixlen, 'Path Groups', pathQty, listItem, 'Circles;Rectangles;Lines;Bitmaps;Paths', button, 'OK;Cancel'
  if button == 1
    stop
  end
  console false

  // bitmap
  bitmap b, 16, 16
  canvasmap b
  line 0,0,15,15
  line 0,15,15,0

  // path
  num p
  if listItem == 4
    setpath()
  end

  // fps
  num timeOld = now()
  num frame
  num totalTime
    
end

func setpath()
  str[] elements
  for i to qty
    num x = rnd(SCREENW)
    num y = rnd(SCREENH)
    format s, 'R{0} {1} {2} {3} 0', x, y, x + pixlen, y + pixlen
    add elements, s
  end
  str sp = join(elements, ' ')
  path p1, sp
  p = p1
end

func draw()
  style FILL
  if listItem == 4
    for i to pathQty
      drawpath p, i, i
    end
  end 

  // fps
  frame++
  num timeNow = now()
  num fps = 1000 / (timeNow - timeOld)
  totalTime += fps
  if frame > 3
    textsize 50
    paint RED
    num avg = round(totalTime/frame)
    text MIDX, MIDY, avg + ' ' + qty
    if avg < 50 and qty > 2
      qty = qty * 99 / 100
      totalTime = 3 * avg
      frame = 3
      if listItem == 4
        setpath()
      end
    end
  end
  timeOld = timeNow
end  
