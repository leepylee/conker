func main()
  num[] sprites

num worldw = 100
num worldh = 30
num spritew = 16
num spriteh = 16

for x to 10
    bitmap b, spritew, spriteh
    canvasmap b
    paint 255, rnd(256), rnd(256), rnd(256)
    line 0,0,15,15
    line 0,15,15,0
    add sprites, b
  end

  num[] tiles
  for y to worldh
    for x to worldw
      add tiles, sprites[rnd(10)]
    end
  end

  num portalx 
  num portaly

  num tileh = 100
  num tilew = 100

  num screenw = roundup(SCREENW / tilew)
  num screenh = roundup(SCREENH / tileh)

  num pixelx 
  num pixely

  num scale = tilew / 16
end

func draw()
  num ty = portaly
  num sy = 0
  while ty < worldh and sy < screenh
    num tx = portalx
    num sx = 0
    while tx < worldw and sx < screenw
	    num b = tiles[tx + ty * worldw]
       drawbitmap b, sx * tilew - pixelx * scale, sy * tileh - pixely, tilew, tileh
      sx++
      tx++
    end
    sy++
    ty++
  end
  pixelx++
  if pixelx > spritew
    portalx++
    pixelx = 0
  end
  printat 0,0,pixelx + " " + portalx + " "
end
